@inject ICategoryRepository  _categoryrepository;

@{
    var user = await _categoryrepository.GetAllCategoryAsync();

}


@if (user != null)

{
    <div class="col-lg-12 col-md-6">
        <h2 class="title-down-internal">CATEGORY</h2>
     


        <nav class="mt-2 momo">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">

                @foreach (var item in user.Where(e => !e.Hidden)) 
                {

                    @if (item.ParentCategory == null && item.Subcategories != null && item.Subcategories.Any())
                    {


                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                <i class="fas fa-angle-left right mt-2"></i>
                                <a asp-controller="Home" asp-action="ViewProduct" asp-route-itemId="@item.Id">   @item.Name</a>
                            </a>
                            
                            @if (Model != null && user.Where(e => item.Id == e.ParentCategoryId) != null && user.Any(e => item.Id == e.ParentCategoryId))
                            {
                                @foreach (var items in user.Where(e => item.Id == e.ParentCategoryId))
                                {
                                    <ul class="nav nav-treeview">
                                        <li class="nav-item">
                                            <a asp-controller="Home" asp-action="ViewProduct" asp-route-itemId="@items.Id" class="nav-link">
                                                <i class="far fa-circle nav-icon"></i>
                                                <p>@items.Name</p>
                                            </a>
                                        </li>

                                    </ul>
                                }
                            }
                            <hr />

                        </li>
                    }
                    else
                    {
                        @if (item.ParentCategory == null && item.Subcategories == null)
                        {
                            <li class=""> <a asp-controller="Home" asp-action="ViewProduct" asp-route-itemId="@item.Id">@item.Name <hr/> </a> </li>
                        }
                    }
                }

            </ul>
        </nav>
    </div>
}






